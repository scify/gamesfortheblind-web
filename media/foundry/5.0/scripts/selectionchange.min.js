!function(){var moduleFactory=function($){var module=this,exports=function(){$.selectionchange=function(undefined){function hasNativeSupport(doc){var osc=doc.onselectionchange;if(osc!==undefined)try{return doc.onselectionchange=0,null===doc.onselectionchange}catch(e){}finally{doc.onselectionchange=osc}return!1}function newWeakMap(){return"undefined"!=typeof WeakMap?new WeakMap:(console.error("selectionchange: WeakMap not supported"),null)}function getSelectionRange(doc){var s=doc.getSelection();return s.rangeCount?s.getRangeAt(0):null
}function on(el,eventType,handler){el.addEventListener(eventType,handler,!0)}function off(el,eventType,handler){el.removeEventListener(eventType,handler,!0)}function onKeyDown(e){var code=e.keyCode;(65===code&&e[SELECT_ALL_MODIFIER]&&!e.shiftKey&&!e.altKey||40>=code&&code>=37&&e.shiftKey)&&setTimeout(dispatchIfChanged.bind(null,this),0)}function onMouseDown(e){0===e.button&&(on(this,"mousemove",onMouseMove),setTimeout(dispatchIfChanged.bind(null,this),0))}function onMouseMove(e){1&e.buttons?dispatchIfChanged(this):off(this,"mousemove",onMouseMove)
}function onMouseUp(e){0===e.button?setTimeout(dispatchIfChanged.bind(null,this),0):off(this,"mousemove",onMouseMove)}function onFocus(){setTimeout(dispatchIfChanged.bind(null,this.document),0)}function dispatchIfChanged(doc){var rOld=ranges.get(doc),rNew=getSelectionRange(doc);sameRange(rNew,rOld)||(ranges.set(doc,rNew),setTimeout(doc.dispatchEvent.bind(doc,new Event("selectionchange")),0))}function sameRange(r1,r2){return r1===r2||r1&&r2&&RANGE_PROPS.every(function(prop){return r1[prop]===r2[prop]})}var ranges,SELECT_ALL_MODIFIER=/^Mac/.test(navigator.platform)?"metaKey":"ctrlKey",RANGE_PROPS=["startContainer","startOffset","endContainer","endOffset"];
return{start:function(doc){var d=doc||document;(ranges||!hasNativeSupport(d)&&(ranges=newWeakMap()))&&(ranges.has(d)||(ranges.set(d,getSelectionRange(d)),on(d,"keydown",onKeyDown),on(d,"mousedown",onMouseDown),on(d,"mousemove",onMouseMove),on(d,"mouseup",onMouseUp),on(d.defaultView,"focus",onFocus)))},stop:function(doc){var d=doc||document;ranges&&ranges.has(d)&&(ranges["delete"](d),off(d,"keydown",onKeyDown),off(d,"mousedown",onMouseDown),off(d,"mousemove",onMouseMove),off(d,"mouseup",onMouseUp),off(d.defaultView,"focus",onFocus))
}}}()};exports(),module.resolveWith(exports)};FD50.module("selectionchange",moduleFactory)}();