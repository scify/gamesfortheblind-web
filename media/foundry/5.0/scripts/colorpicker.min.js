!function(){var moduleFactory=function($){var module=this,exports=function(){var hsbPanel_=".colorpicker-hsb-panel",hPanel_=".colorpicker-h-panel",sbPanel_=".colorpicker-sb-panel",hHandle_=".colorpicker-h-handle",sbHandle_=".colorpicker-sb-handle",colorPreview_=".colorpicker-preview",hexInput_=".colorpicker-hex-input",defaultOptions={color:"#000000",document:document};$.fn.colorpicker=function(options){var colorpicker=this.data("colorpicker");if(colorpicker||(colorpicker=new Colorpicker(this,options)),$.isString(options)){var method=options;
return colorpicker[method].apply(colorpicker,$.makeArray(arguments).slice(1))}return this};var Colorpicker=function(element,options){this.options=$.extend({},defaultOptions,options),this.element=element,this.init(),element.data("colorpicker",this)};$.extend(Colorpicker.prototype,{init:function(){this.initHPanel(),this.initSBPanel(),this.initHexInput(),this.silent=!0,this.setHex(this.options.color),this.silent=!1},initHPanel:function(){var self=this;self.generateHueColors(),self.element.on($.ns("mousedown",".colorpicker.h"),hPanel_,function(event){event.preventDefault();
var hsbPanel=self.hsbPanel(),hPanel=self.hPanel(),hHandle=self.hHandle(),offset=hPanel.offset(),offsetY=offset.top,height=hPanel.height(),updateH=function(event){var position=$.getPointerPosition(event),y=position.y-offsetY,py=y/height;0>py&&(py=0),py>1&&(py=1),hHandle.css({top:100*py+"%"});var hsb=self.getHsb();self.setHsb(hsb)};hsbPanel.addClass("adjusting-h"),updateH(event);var $document=$(self.options.document);$document.on($.ns("mousemove touchmove",".colorpicker.h"),function(event){event.preventDefault(),updateH(event)
}).on($.ns("mouseup touchend",".colorpicker.h"),function(event){event.preventDefault(),hsbPanel.removeClass("adjusting-h"),$document.off($.ns("mousemove mouseup touchend",".colorpicker.h"))})})},destroyHPanel:function(){this.element.off($.ns("mousedown",".colorpicker.h"))},generateHueColors:function(){var hPanel=this.hPanel(),stops=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if($.IE<=9){var i,div;for(i=0;11>=i;i++)div=$('<div class="colorpicker-hue-stop"></div>').attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+stops[i]+", endColorstr="+stops[i+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+stops[i]+", endColorstr="+stops[i+1]+')";'),hPanel.append(div)
}else stopList=stops.join(","),hPanel.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")},initSBPanel:function(){var self=this;self.element.on($.ns("mousedown",".colorpicker.sb"),sbPanel_,function(event){var hsbPanel=self.hsbPanel(),sbPanel=self.sbPanel(),sbHandle=self.sbHandle(),offset=sbPanel.offset(),offsetX=offset.left,offsetY=offset.top,width=sbPanel.width(),height=sbPanel.height(),updateSB=function(event){var position=$.getPointerPosition(event),x=position.x-offsetX,y=position.y-offsetY,px=x/width,py=y/height;
0>px&&(px=0),px>1&&(px=1),0>py&&(py=0),py>1&&(py=1),sbHandle.css({top:100*py+"%",left:100*px+"%"});var hsb=self.getHsb();self.setHsb(hsb)};hsbPanel.addClass("adjusting-sb"),updateSB(event);var $document=$(self.options.document);$document.on($.ns("mousemove touchmove",".colorpicker.sb"),function(event){event.preventDefault(),updateSB(event)}).on($.ns("mouseup touchend",".colorpicker.sb"),function(){event.preventDefault(),hsbPanel.removeClass("adjusting-sb"),$document.off($.ns("mousemove mouseup touchend",".colorpicker.sb"))
})})},destroySBPanel:function(){this.element.off($.ns("mousedown",".colorpicker.sb"))},initHexInput:function(){var self=this;self.element.on("input",hexInput_,function(){var hex=$.fixHex($.trim(self.hexInput().val().replace(/\#/g,"")));self.setHex(hex)}).on("focusin",hexInput_,function(){self.hexInput().addClass("is-focused")}).on("focusout",hexInput_,function(){var hexInput=self.hexInput(),normalizedHex=hexInput.data("value");hexInput.removeClass("is-focused").val(normalizedHex)})},setHsb:function(hsb){var hsbPanel=this.hsbPanel();
hsbPanel.hasClass("adjusting-h")||hsbPanel.hasClass("adjusting-sb")||this.hHandle().css({top:100*(1-hsb.h/360)+"%"}),hsbPanel.hasClass("adjusting-sb")||this.sbPanel().css({background:"#"+$.hsbToHex({h:hsb.h,s:100,b:100})}),this.sbHandle().css({left:hsb.s+"%",top:100-hsb.b+"%"});var hex="#"+$.hsbToHex(hsb),hexInput=this.hexInput();hexInput.data("value",hex),!hexInput.hasClass("is-focused")&&hexInput.val(hex),this.colorPreview().css("background",hex),!this.silent&&this.element.trigger("colorpickerChange",hex,hsb)
},getHsb:function(){var hHandle=this.hHandle();sbHandle=this.sbHandle();var hsb={h:360*(1-parseFloat(hHandle[0].style.top)/100),s:parseFloat(sbHandle[0].style.left),b:100-parseFloat(sbHandle[0].style.top)};return $.fixHsb(hsb)},setHex:function(hex){var hex=hex.replace(/\#/g,"");this.setHsb($.hexToHsb(hex))},getHex:function(){return"#"+$.hsbToHex(this.getHsb())},setRgb:function(rgb){if($.isString(rgb)){var parts=rgb.match(/\d+/g);rgb={r:parts[0]||0,g:parts[1]||0,b:parts[2]||0}}this.setHsb($.rgbToHsb(rgb))},getRgb:function(){return $.hsbToRgb(this.getHsb())
},setColor:function(color){color.match(/^rgb/i)&&this.setRgb(color),color.match(/^\#/)&&this.setHex(color)},hsbPanel:function(){return this.element.find(hsbPanel_)},hPanel:function(){return this.element.find(hPanel_)},sbPanel:function(){return this.element.find(sbPanel_)},hHandle:function(){return this.element.find(hHandle_)},sbHandle:function(){return this.element.find(sbHandle_)},colorPreview:function(){return this.element.find(colorPreview_)},hexInput:function(){return this.element.find(hexInput_)},widget:function(){return this
}})};exports(),module.resolveWith(exports)};FD50.module("colorpicker",moduleFactory)}();